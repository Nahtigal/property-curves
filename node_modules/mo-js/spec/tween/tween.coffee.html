<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title> - tween.coffee</title>

  <link rel="stylesheet" href="../../../assets/style.css">
  
    
      <style>
        
      </style>
    
  

  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"/>
  <meta name="groc-relative-root" content="../../../"/>
  <meta name="groc-document-path" content="../spec/tween/tween.coffee"/>
  
</head>
<body>
  <div id="file-area">
    <div id="meta">
      <code class="file-path">
      
        <a href="https://github.com/legomushroom/mojs.git/blob/master/../spec/tween/tween.coffee">../spec/tween/tween.coffee</a>
      
      </code>
    </div>
    <div id="document">
    
      <div class="segment">
      
      
        <div class="code"><div class="wrapper">Tween    = <span class="hljs-built_in">window</span>.mojs.Tween
Timeline = <span class="hljs-built_in">window</span>.mojs.Timeline
tweener  = <span class="hljs-built_in">window</span>.mojs.tweener

describe <span class="hljs-string">'Tween -&gt;'</span>, <span class="hljs-function">-&gt;</span>
  beforeEach -&gt; tweener.removeAll()
  it <span class="hljs-string">'should have timelines var'</span>, <span class="hljs-function">-&gt;</span>
    t = <span class="hljs-keyword">new</span> Tween
    expect(t.timelines.length).toBe <span class="hljs-number">0</span>
    expect(t.props.totalTime) .toBe <span class="hljs-number">0</span>
  it <span class="hljs-string">'should have initial state flags'</span>, <span class="hljs-function">-&gt;</span>
    t = <span class="hljs-keyword">new</span> Tween
    expect(t.state).toBe <span class="hljs-string">'stop'</span>
  describe <span class="hljs-string">'add method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should add timeline'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline
      expect(t.timelines.length).toBe <span class="hljs-number">1</span>
      expect(t.timelines[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
    it <span class="hljs-string">'should work with arrays of tweens'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t1 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>
      t2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1500</span>
      t.add [t1, t2, <span class="hljs-keyword">new</span> Tween]
      expect(t.timelines.length).toBe <span class="hljs-number">3</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">1500</span>
      expect(t.timelines[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
      expect(t.timelines[<span class="hljs-number">1</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
      expect(t.timelines[<span class="hljs-number">2</span>] <span class="hljs-keyword">instanceof</span> Tween)   .toBe <span class="hljs-literal">true</span>
    it <span class="hljs-string">'should work with arguments'</span>,<span class="hljs-function">-&gt;</span>
      tween = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">isIt</span>: <span class="hljs-literal">true</span>
      t1 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>
      tween.add t1, t2
      expect(tween.props.totalTime) .toBe <span class="hljs-number">1000</span>
      expect(tween.timelines.length).toBe <span class="hljs-number">2</span>
    it <span class="hljs-string">'should work with mixed arguments'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t1 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>
      t2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1500</span>
      t.add [t1, <span class="hljs-keyword">new</span> Timeline, <span class="hljs-keyword">new</span> Tween], t2
      expect(t.timelines.length).toBe <span class="hljs-number">4</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">1500</span>
      expect(t.timelines[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
      expect(t.timelines[<span class="hljs-number">1</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
      expect(t.timelines[<span class="hljs-number">2</span>] <span class="hljs-keyword">instanceof</span> Tween)   .toBe <span class="hljs-literal">true</span>
      expect(t.timelines[<span class="hljs-number">3</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
    it <span class="hljs-string">'should calc self duration'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">700</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>, <span class="hljs-attribute">repeat</span>: <span class="hljs-number">1</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">1400</span>
    it <span class="hljs-string">'should work with another tweens'</span>,<span class="hljs-function">-&gt;</span>
      t1 = <span class="hljs-keyword">new</span> Tween
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>, <span class="hljs-attribute">repeat</span>: <span class="hljs-number">1</span>
      t1.add t
      expect(t1.props.totalTime).toBe <span class="hljs-number">1400</span>

  describe <span class="hljs-string">'pushTimeline method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should push timeline to timelines and calc totalTime'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.pushTimeline <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">4000</span>
      expect(t.timelines.length).toBe <span class="hljs-number">1</span>
      expect(t.timelines[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">4000</span>

  describe <span class="hljs-string">'append method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should add timeline'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.append <span class="hljs-keyword">new</span> Timeline
      expect(t.timelines.length).toBe <span class="hljs-number">1</span>
      expect(t.timelines[<span class="hljs-number">0</span>] <span class="hljs-keyword">instanceof</span> Timeline).toBe <span class="hljs-literal">true</span>
    it <span class="hljs-string">'should delay the timeline to duration'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.append <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>
      expect(t.timelines[<span class="hljs-number">1</span>].o.delay).toBe <span class="hljs-number">1700</span>
    it <span class="hljs-string">'should recalc duration'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.append <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">2200</span>
    it <span class="hljs-string">'should work with array'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      tm1 = <span class="hljs-keyword">new</span> Timeline(<span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>)
      tm2 = <span class="hljs-keyword">new</span> Timeline(<span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">700</span>)
      t.append [tm1, tm2]
      expect(t.timelines.length).toBe <span class="hljs-number">3</span>
      expect(t.props.totalTime).toBe <span class="hljs-number">2400</span>
    it <span class="hljs-string">'should work with array #2'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      tm1 = <span class="hljs-keyword">new</span> Timeline(<span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>)
      tm2 = <span class="hljs-keyword">new</span> Timeline(<span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">700</span>)
      spyOn t, <span class="hljs-string">'recalcDuration'</span>
      t.append [tm1, tm2]
      expect(t.recalcDuration).toHaveBeenCalled()
    it <span class="hljs-string">'should work with array #2'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.append <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      expect(t.timelines.length).toBe <span class="hljs-number">1</span>
    it <span class="hljs-string">'should add element index'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.append <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.append <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      expect(t.timelines[<span class="hljs-number">0</span>].index).toBe <span class="hljs-number">0</span>
      expect(t.timelines[<span class="hljs-number">1</span>].index).toBe <span class="hljs-number">1</span>

  describe <span class="hljs-string">'remove method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should remove timeline'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline
      t.add timeline
      t.remove timeline
      expect(t.timelines.length).toBe <span class="hljs-number">0</span>
    it <span class="hljs-string">'should remove tween'</span>,<span class="hljs-function">-&gt;</span>
      t1 = <span class="hljs-keyword">new</span> Tween
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline
      t.add timeline
      t1.add t
      t1.remove t
      expect(t1.timelines.length).toBe <span class="hljs-number">0</span>
  
  describe <span class="hljs-string">'recalcDuration method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should recalculate duration'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline  <span class="hljs-attribute">duration</span>: <span class="hljs-number">100</span>
      timeline2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">1000</span>
      t.add timeline
      t.timelines.push timeline2
      t.recalcDuration()
      expect(t.props.totalTime).toBe <span class="hljs-number">1000</span>
    
  describe <span class="hljs-string">'start method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should get the start time'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.start()
      expect(t.props.startTime).toBeDefined()
      expect(t.props.endTime).toBe t.props.startTime + t.props.totalTime
    it <span class="hljs-string">'should call the setStartTime method'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      spyOn t, <span class="hljs-string">'setStartTime'</span>
      time = <span class="hljs-number">0</span>
      t.start time
      expect(t.setStartTime).toHaveBeenCalledWith time

    it <span class="hljs-string">'should start every timeline'</span>,<span class="hljs-function">-&gt;</span>
      it <span class="hljs-string">'should update the current time on every timeline'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">100</span>
      spyOn t.timelines[<span class="hljs-number">0</span>], <span class="hljs-string">'start'</span>
      spyOn t.timelines[<span class="hljs-number">1</span>], <span class="hljs-string">'start'</span>
      t.start()
      expect(t.timelines[<span class="hljs-number">0</span>].start).toHaveBeenCalledWith t.props.startTime
      expect(t.timelines[<span class="hljs-number">1</span>].start).toHaveBeenCalledWith t.props.startTime
    it <span class="hljs-string">'should add itself to tweener'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      spyOn tweener, <span class="hljs-string">'add'</span>
      t.start()
      expect(tweener.add).toHaveBeenCalled()
    it <span class="hljs-string">'should not add itself to tweener if time was passed'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      spyOn tweener, <span class="hljs-string">'add'</span>
      t.start <span class="hljs-number">10239123</span>
      expect(tweener.add).<span class="hljs-keyword">not</span>.toHaveBeenCalled()
    it <span class="hljs-string">'should set state to "play"'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add(timeline); t.start()
      expect(t.state).toBe <span class="hljs-string">'play'</span>
    
  describe <span class="hljs-string">'removeFromTweener method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should call t.remove method with self'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add timeline
      t.start()
      t.removeFromTweener()
      expect(tweener.tweens.length).toBe <span class="hljs-number">0</span>

  describe <span class="hljs-string">'pause method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should call t.remove method with self'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add timeline
      t.start()
      spyOn t, <span class="hljs-string">'removeFromTweener'</span>
      t.pause()
      expect(t.removeFromTweener).toHaveBeenCalled()

    it <span class="hljs-string">'should set state to "pause"'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add(timeline); t.start(); t.pause()
      expect(t.state).toBe <span class="hljs-string">'pause'</span>
  
  describe <span class="hljs-string">'stop method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should call t.removeFromTweener method with self'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []; t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add timeline
      t.start()
      spyOn t, <span class="hljs-string">'removeFromTweener'</span>
      t.stop()
      expect(t.removeFromTweener).toHaveBeenCalled()

    it <span class="hljs-string">'should reset progress to 0'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []; t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add timeline
      t.start()
      spyOn t, <span class="hljs-string">'setProgress'</span>
      t.stop()
      expect(t.setProgress).toHaveBeenCalledWith <span class="hljs-number">0</span>

    it <span class="hljs-string">'should set state to "stop"'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add(timeline); t.start(); t.stop()
      expect(t.state).toBe <span class="hljs-string">'stop'</span>

  describe <span class="hljs-string">'restart method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should call stop method'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add(timeline); t.start()
      spyOn t, <span class="hljs-string">'stop'</span>
      t.restart()
      expect(t.stop).toHaveBeenCalled()
    it <span class="hljs-string">'should call start method'</span>,<span class="hljs-function">-&gt;</span>
      tweener.tweens = []
      t = <span class="hljs-keyword">new</span> Tween
      timeline = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">2000</span>
      t.add(timeline); t.start()
      spyOn t, <span class="hljs-string">'start'</span>
      t.restart()
      expect(t.start).toHaveBeenCalled()
</div></div>
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>probaly no needed for this
describe &#39;resetProgress method -&gt;&#39;, -&gt;
  it &#39;should call setProgress with 0&#39;, -&gt;
    t = new Tween
    timeline1 = new Timeline duration: 2000
    timeline2 = new Timeline duration: 2000
    t.add(timeline1, timeline2)
    t.setStartTime()
    spyOn t, &#39;setProgress&#39;
    t.resetProgress()
    expect(t.setProgress).toHaveBeenCalledWith 0
  it &#39;should update every timeline with its initial time&#39;, -&gt;
    t = new Tween
    tm1 = new Timeline duration: 2000, delay: 500
    tm2 = new Timeline duration: 2000, delay: 100
    t.add(tm1, tm2)
    t.setStartTime()
    spyOn tm1, &#39;update&#39;
    spyOn tm2, &#39;update&#39;
    t.resetProgress()
    expect(tm1.update).toHaveBeenCalledWith tm1.props.startTime
    expect(tm2.update).toHaveBeenCalledWith tm2.props.startTime</p>
</div>
        </div>
      
      
      </div>
    
      <div class="segment">
      
        <div class="comments ">
          <div class="wrapper"><p>  it &#39;should call resetProgress on every tween&#39;, -&gt;
    t = new Tween
    tm1 = new Timeline duration: 2000, delay: 500
    tw1 = new Tween
    tw1.add tm1
    tm2 = new Timeline duration: 2000, delay: 100
    t.add(tw1, tm2)
    t.setStartTime()
    spyOn tw1, &#39;resetProgress&#39;
    spyOn tm2, &#39;update&#39;
    t.resetProgress()
    expect(tw1.resetProgress).toHaveBeenCalled()
    expect(tm2.update).toHaveBeenCalledWith tm2.props.startTime</p>
</div>
        </div>
      
      
        <div class="code"><div class="wrapper">  describe <span class="hljs-string">'onReverseComplete callback -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should be defined'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onReverseComplete</span>: <span class="hljs-function">-&gt;</span>
      expect(t.o.onReverseComplete).toBeDefined()

    it <span class="hljs-string">'should call onReverseComplete callback'</span>, <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween(<span class="hljs-attribute">onReverseComplete</span>:<span class="hljs-function">-&gt;</span>)
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">10</span>
      spyOn(t.o, <span class="hljs-string">'onReverseComplete'</span>); t.start()
      t.setProgress .<span class="hljs-number">5</span>
      t.setProgress <span class="hljs-number">0</span>
      expect(t.o.onReverseComplete).toHaveBeenCalled()

    it <span class="hljs-string">'should not be called on start'</span>, <span class="hljs-function"><span class="hljs-params">()</span>-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween(<span class="hljs-attribute">onReverseComplete</span>:<span class="hljs-function">-&gt;</span>)
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">10</span>
      spyOn(t.o, <span class="hljs-string">'onReverseComplete'</span>); t.start()
      t.setProgress <span class="hljs-number">0</span>
      expect(t.o.onReverseComplete).<span class="hljs-keyword">not</span>.toHaveBeenCalled()

  describe <span class="hljs-string">'onComplete callback -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should be defined'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onComplete</span>: <span class="hljs-function">-&gt;</span>
      expect(t.o.onComplete).toBeDefined()
    it <span class="hljs-string">'should call onComplete callback'</span>, <span class="hljs-function"><span class="hljs-params">(dfr)</span>-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween(<span class="hljs-attribute">onComplete</span>:<span class="hljs-function">-&gt;</span>)
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">10</span>
      spyOn(t.o, <span class="hljs-string">'onComplete'</span>); t.start()
      setTimeout -&gt;
        expect(t.o.onComplete).toHaveBeenCalled(); dfr()
      , <span class="hljs-number">200</span>
    it <span class="hljs-string">'should have the right scope'</span>, <span class="hljs-function"><span class="hljs-params">(dfr)</span>-&gt;</span>
      isRightScope = <span class="hljs-literal">false</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onComplete</span>:<span class="hljs-function">-&gt;</span> isRightScope = @ <span class="hljs-keyword">instanceof</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      t.start()
      setTimeout (<span class="hljs-function">-&gt;</span> expect(isRightScope).toBe(<span class="hljs-literal">true</span>); dfr()), <span class="hljs-number">100</span>

    it <span class="hljs-string">'should fire after the last onUpdate'</span>, <span class="hljs-function"><span class="hljs-params">(dfr)</span>-&gt;</span>
      proc = <span class="hljs-number">0</span>
      tween = <span class="hljs-keyword">new</span> Tween
        <span class="hljs-attribute">isIt</span>: <span class="hljs-literal">true</span>
        <span class="hljs-attribute">onUpdate</span>:<span class="hljs-function"><span class="hljs-params">(p)</span>-&gt;</span> proc = p
        <span class="hljs-attribute">onComplete</span>:<span class="hljs-function">-&gt;</span> expect(proc).toBe(<span class="hljs-number">1</span>); dfr()
      tween.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      tween.start()
      tween.update tween.props.startTime + <span class="hljs-number">22</span>

  describe <span class="hljs-string">'onUpdate callback -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should be defined'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onUpdate</span>: <span class="hljs-function">-&gt;</span>
      expect(t.onUpdate).toBeDefined()
    it <span class="hljs-string">'should call onUpdate callback'</span>, <span class="hljs-function"><span class="hljs-params">(dfr)</span>-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween(<span class="hljs-attribute">onUpdate</span>:<span class="hljs-function">-&gt;</span>)
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      spyOn(t, <span class="hljs-string">'onUpdate'</span>); t.start()
      setTimeout -&gt;
        expect(t.onUpdate).toHaveBeenCalled()
        dfr()
      , <span class="hljs-number">100</span>
    it <span class="hljs-string">'should have the right scope'</span>, <span class="hljs-function"><span class="hljs-params">(dfr)</span>-&gt;</span>
      isRightScope = <span class="hljs-literal">false</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onUpdate</span>:<span class="hljs-function">-&gt;</span> isRightScope = @ <span class="hljs-keyword">instanceof</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      t.start()
      setTimeout (<span class="hljs-function">-&gt;</span> expect(isRightScope).toBe(<span class="hljs-literal">true</span>); dfr()), <span class="hljs-number">100</span>
    it <span class="hljs-string">'should pass the current progress'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onUpdate</span>:<span class="hljs-function">-&gt;</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      spyOn(t, <span class="hljs-string">'onUpdate'</span>); t.start()
      t.update t.props.startTime + <span class="hljs-number">10</span>
      expect(t.onUpdate).toHaveBeenCalledWith .<span class="hljs-number">5</span>
    it <span class="hljs-string">'should not run if time is less then startTime'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onUpdate</span>:<span class="hljs-function">-&gt;</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      spyOn(t, <span class="hljs-string">'onUpdate'</span>); t.start()
      t.update t.props.startTime - <span class="hljs-number">10</span>
      expect(t.onUpdate).<span class="hljs-keyword">not</span>.toHaveBeenCalled()
    it <span class="hljs-string">'should run if time is greater then endTime'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onUpdate</span>:<span class="hljs-function">-&gt;</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      spyOn(t, <span class="hljs-string">'onUpdate'</span>); t.start()
      t.update t.props.startTime + <span class="hljs-number">25</span>
      expect(t.onUpdate).toHaveBeenCalledWith <span class="hljs-number">1</span>

  describe <span class="hljs-string">'onStart callback -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should be defined'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onStart</span>: <span class="hljs-function">-&gt;</span>
      expect(t.o.onStart).toBeDefined()
    it <span class="hljs-string">'should call onStart callback'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween(<span class="hljs-attribute">onStart</span>:<span class="hljs-function">-&gt;</span>)
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">10</span>
      spyOn(t.o, <span class="hljs-string">'onStart'</span>); t.start()
      expect(t.o.onStart).toHaveBeenCalled()
    it <span class="hljs-string">'should have the right scope'</span>, <span class="hljs-function">-&gt;</span>
      isRightScope = <span class="hljs-literal">false</span>
      t = <span class="hljs-keyword">new</span> Tween <span class="hljs-attribute">onStart</span>:<span class="hljs-function">-&gt;</span> isRightScope = @ <span class="hljs-keyword">instanceof</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">20</span>
      t.start()
      expect(isRightScope).toBe(<span class="hljs-literal">true</span>)
  describe <span class="hljs-string">'update method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should update the current time on every timeline'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">100</span>
      spyOn t.timelines[<span class="hljs-number">0</span>], <span class="hljs-string">'update'</span>
      spyOn t.timelines[<span class="hljs-number">1</span>], <span class="hljs-string">'update'</span>
      t.update time = performance.now() + <span class="hljs-number">200</span>
      expect(t.timelines[<span class="hljs-number">0</span>].update).toHaveBeenCalledWith time
      expect(t.timelines[<span class="hljs-number">1</span>].update).toHaveBeenCalledWith time

    it <span class="hljs-string">'should return true is ended'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">100</span>
      t.start()
      expect(t.update(performance.now() + <span class="hljs-number">2000</span>)).toBe <span class="hljs-literal">true</span>

    it <span class="hljs-string">'should not go further then endTime'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.start()
      t.update t.props.startTime + <span class="hljs-number">1000</span>
      expect(t.prevTime).toBe t.props.endTime

    it <span class="hljs-string">'should work with tweens'</span>,<span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      t1 = <span class="hljs-keyword">new</span> Tween
      t2 = <span class="hljs-keyword">new</span> Tween
      ti1 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      spyOn ti1, <span class="hljs-string">'update'</span>
      ti2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">100</span>
      spyOn ti2, <span class="hljs-string">'update'</span>
      ti3 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">100</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">0</span>
      spyOn ti3, <span class="hljs-string">'update'</span>
      ti4 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">800</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>
      spyOn ti4, <span class="hljs-string">'update'</span>
      t1.add(ti1); t1.add(ti2); t2.add(ti3); t2.add(ti4)
      t.add(t1); t.add(t2)
      t.start()
      t.update time = t.props.startTime + <span class="hljs-number">300</span>
      expect(ti1.update).toHaveBeenCalledWith time
      expect(ti2.update).toHaveBeenCalledWith time
      expect(ti3.update).toHaveBeenCalledWith time
      expect(ti4.update).toHaveBeenCalledWith time

  describe <span class="hljs-string">'setProgress method -&gt;'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should call the update on every child with progress time'</span>, <span class="hljs-function">-&gt;</span>
      t   = <span class="hljs-keyword">new</span> Tween
      t1  = <span class="hljs-keyword">new</span> Tween
      t2  = <span class="hljs-keyword">new</span> Tween
      ti1 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      spyOn ti1, <span class="hljs-string">'update'</span>
      ti2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">100</span>
      spyOn ti2, <span class="hljs-string">'update'</span>
      ti3 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">100</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">0</span>
      spyOn ti3, <span class="hljs-string">'update'</span>
      ti4 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">800</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>
      spyOn ti4, <span class="hljs-string">'update'</span>
      t1.add(ti1); t1.add(ti2); t2.add(ti3); t2.add(ti4)
      t.add(t1); t.add(t2)
      t.prepareStart(); t.startTimelines()
      t.setProgress .<span class="hljs-number">5</span>
      time = t.props.startTime + <span class="hljs-number">650</span>
      expect(ti1.update).toHaveBeenCalledWith time
      expect(ti2.update).toHaveBeenCalledWith time
      expect(ti3.update).toHaveBeenCalledWith time
      expect(ti4.update).toHaveBeenCalledWith time
    it <span class="hljs-string">'should call setStartTime if there is no @props.startTime'</span>, <span class="hljs-function">-&gt;</span>
      t = <span class="hljs-keyword">new</span> Tween
      spyOn t, <span class="hljs-string">'setStartTime'</span>
      t.setProgress .<span class="hljs-number">5</span>
      expect(t.setStartTime).toHaveBeenCalled()

    it <span class="hljs-string">'should call self update'</span>, <span class="hljs-function">-&gt;</span>
      t   = <span class="hljs-keyword">new</span> Tween
      t1  = <span class="hljs-keyword">new</span> Tween
      t2  = <span class="hljs-keyword">new</span> Tween
      ti1 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      ti2 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">100</span>
      ti3 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">100</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">0</span>
      ti4 = <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">800</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">500</span>
      t1.add(ti1); t1.add(ti2); t2.add(ti3); t2.add(ti4)
      t.add(t1); t.add(t2)
      t.prepareStart(); t.startTimelines()
      spyOn t, <span class="hljs-string">'update'</span>
      t.setProgress .<span class="hljs-number">5</span>
      expect(t.update).toHaveBeenCalledWith t.props.startTime + <span class="hljs-number">650</span>
    it <span class="hljs-string">'should not set the progress more then 1'</span>, <span class="hljs-function">-&gt;</span>
      t   = <span class="hljs-keyword">new</span> Tween; t1  = <span class="hljs-keyword">new</span> Tween
      t1.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.add(t1); t.prepareStart(); t.startTimelines()
      spyOn t, <span class="hljs-string">'update'</span>
      t.setProgress <span class="hljs-number">1.5</span>
      expect(t.update).toHaveBeenCalledWith t.props.startTime+t.props.totalTime
    it <span class="hljs-string">'should not set the progress less then 0'</span>, <span class="hljs-function">-&gt;</span>
      t   = <span class="hljs-keyword">new</span> Tween; t1  = <span class="hljs-keyword">new</span> Tween
      t1.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      t.add(t1); t.prepareStart(); t.startTimelines()
      spyOn t, <span class="hljs-string">'update'</span>
      t.setProgress -<span class="hljs-number">1.5</span>
      expect(t.update).toHaveBeenCalledWith t.props.startTime

  describe <span class="hljs-string">'setStartTime method'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should call prepareStart and startTimelines methods'</span>, <span class="hljs-function">-&gt;</span>
      t   = <span class="hljs-keyword">new</span> Tween; t1  = <span class="hljs-keyword">new</span> Tween
      t1.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>, <span class="hljs-attribute">delay</span>: <span class="hljs-number">200</span>
      spyOn t, <span class="hljs-string">'prepareStart'</span>
      spyOn t, <span class="hljs-string">'startTimelines'</span>
      time = <span class="hljs-number">0</span>
      t.setStartTime time
      expect(t.prepareStart)  .toHaveBeenCalled()
      expect(t.startTimelines).toHaveBeenCalledWith time

  describe <span class="hljs-string">'time track'</span>, <span class="hljs-function">-&gt;</span>
    it <span class="hljs-string">'should save the current time track'</span>, <span class="hljs-function">-&gt;</span>
      t   = <span class="hljs-keyword">new</span> Tween
      t.add <span class="hljs-keyword">new</span> Timeline <span class="hljs-attribute">duration</span>: <span class="hljs-number">500</span>
      t.setProgress .<span class="hljs-number">5</span>
      expect(t.prevTime).toBe t.props.startTime + <span class="hljs-number">250</span>


      



      


</div></div>
      
      </div>
    
    </div>
  </div>

  <script src="../../../toc.js"></script>
  <script src="../../../assets/libs.js"></script>
  <script src="../../../assets/behavior.js"></script>

  
    
      <script>
        
      </script>
    
  
</body>
</html>